---
title: Secure video playback
description: Secure video playback with access control
---

import CodeBlock from "@theme/CodeBlock";
import CodeBlockTabs from "@site/src/components/CodeBlockTabs";
import CodeBlockTabItem from "@site/src/components/CodeBlockTabItem";

# Secure video playback

You can set a playback policy for a livestream to secure video playback.

Your playback policy can be either:
- `public` - No access control is applied to the asset
- `jwt` - A JSON Web Token (JWT) is required to playback the asset

If you set your stream's playback policy to JWT, you will 
need to sign a token with a signing key and put it in the playback URL
to be able to playback your stream.

## Step 1: Create a livestream with a signed playback policy

Create a livestream with a signed playback policy. The playback policy can 
be specified when creating a new live stream, or can be added to an existing 
[live stream](https://docs.livepeer.studio/reference/api/update-stream).

## Step 2: Create a signing key

A signing key is used to sign JWTs and are necessary to make a stream private.
You can find more information about the response object [here](https://docs.livepeer.studio/reference/api/create-signing-keys).

:::caution
The `privateKey` field generated by this request is available only
on creation and cannot be retrieved later.
:::

<CodeBlockTabs>
<CodeBlockTabItem value="JavaScript" label="JavaScript">

```js
const response = await fetch(
  "https://livepeer.studio/api/access-control/signing-key",
  {
    method: "POST",
    headers: {
      Authorization: `Bearer ${process.env.API_TOKEN}`,
      "Content-Type": "application/json",
    }
  }
);

const responseObject = await response.json();
```

</CodeBlockTabItem>
</CodeBlockTabs>

## Step 3: Sign the JWT

After setting up your livestream and signing key, you will need to sign the JWT so you can use it.

<CodeBlockTabs>
<CodeBlockTabItem value="JavaScript" label="JavaScript">

```js
import jwt, { JsonWebTokenError, JwtPayload } from "jsonwebtoken";

/* LIVEPEER JS IMPORTS WHEN SIGNING KEYS ARE GOING TO BE INTEGRATED*/
/*import {
  LivepeerConfig,
  createReactClient,
  studioProvider,
} from '@livepeer/react';
import { useCreateSigningKey } from '@livepeer/react';
 
const client = createReactClient({
  provider: studioProvider({ apiKey: 'yourStudioApiKey' }),
});*/ 

const signingKey = // Livepeer.js function to create a signing key
const privateKey = signingKey.privateKey; // decoded from base64

// db.keys.save(privateKey) // Store it! It's received only on signing key creation!

const expiration = Math.floor(Date.now() / 1000) + 1000;
const payload: JwtPayload = {
        sub: "b0dcxvwml48mxt2s", // Playback ID
        action: "pull", // Allowed action for this token. `pull` is allowing playback
        custom: {
						"session_id": "xxxx-123",
            "user_id": "xxxx-123"
				}
				iss: "lenstube",
        pub: signingKey.publicKey, // REQUIRED: The public key of your keypair
        exp: expiration, // Expiry date of your JWT
        video: "none",
};
const token = jwt.sign(payload, privateKey, { algorithm: "ES256" });
```

</CodeBlockTabItem>
</CodeBlockTabs>


## Step 4: Include the JSON Web Token (JWT) in the media URL

Your livestream is now privately secured! To playback a JWT secured video,
you will need to add the token to your URL as such:
```https://livepeercdn.com/hls/4be03pfwk16x18ve/index.m3u8?jwt=$JWT_TOKEN```

